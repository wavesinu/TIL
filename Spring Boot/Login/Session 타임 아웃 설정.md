#session

세션은 사용자가 로그아웃을 직접 호출해서 `session.invalidate()`가 호출되는 경우에 삭재된다. 그러나 대부분의 사용자는 로그아웃을 선택하지 않고, 웹 브라우저를 종료한다.
문제는 [[Spring Boot/Login/HTTP]]가 비 연결성(ConnectionLess)이기 때문에 서버 입장에서는 해당 사용자가 웹 브라우저를 종료한 것인지 아닌지 인식할 수 없다.

이 경우 남아있는 세션을 무한정 보관하는 경우 다음과 같은 문제가 발생할 수 있다.

- 세션과 관련된 쿠키(`JSESSIONID`)가 탈취 당했을 경우 오랜 시간이 지나도 해당 쿠키로 악의적 요청을 할 수 있다.
- **세션은 기본적으로 메모리에 실행**된다. 메모리의 크기가 무한하지 않기 떄문에, 꼭 필요한 경우에만 생성해서 사용해야 한다.
	- 10만명의 사용자가 로그인하면 10만 개의 세션이 생성된다.

### 세션의 종료 시점
세션의 종료 시점을 30분으로 설정하는 경우, 30분이 지나면 세션이 삭제되기 때문에 30분마다 다시 로그인해야 하는 문제가 발생한다. 
이 문제의 대안으로 세션 생성 시점이 아닌, 사용자가 서버에 최근에 요청한 시간을 기준으로 30분 정도를 유지해주는 것이다. 이렇게 하면 사용자가 서비스를 게속 이용하는 경우, 세션의 생존 시간이 30분으로 계속 늘어나게 된다.
>`HttpSession`은 이 방식을 사용한다.

---
### 세션 타임아웃 설정
##### 스프링 부트로 글로벌 설정
```java
//application.properties
server.servlet.session.timeout=60
```
(글로벌 설정은 분 단위로 설정해야 함.)
##### 특정 세션 단위로 시간 설정
```java
session.setMaxInactiveInterval(1800);  //1800초
```