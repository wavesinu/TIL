쿠키에 중요한 정보를 보관하는 방법은 보안 문제가 발생할 수 있다. 이를 해결하기 위해 중요한 정보는 모두 서버에 저장해야 하고, 클라이언트와 서버는 추정 불가능한 임의의 식별자 값으로 연결해야 한다.
### 세션 동작 방식
##### 로그인
![[CleanShot 2024-02-18 at 21.39.58@2x.png]]
- 사용자가 `loginId`, `password` 정보를 전달하면 서버에서 해당 사용자가 맞는지 확인함.
##### 세션 생성
![[CleanShot 2024-02-18 at 21.41.28@2x.png]]
- [[UUID]]는 추정 불가능하다.
- 생성된 세션 ID와 세션에 보관할 값을 서버의 세션 저장소에 보관한다.
##### 세션id를 응답 쿠키로 전달
![[CleanShot 2024-02-18 at 21.44.40@2x.png]]
>**클라이언트와 서버는 결국 쿠키로 연결되어야 한다.**
- 서버는 클라이언트에 `mySessionId`라는 이름으로 세션ID만 쿠키에 담아 전달한다.
- 클라이언트는 쿠키 저장소에 `mySessionId` 쿠키를 보관한다.
##### 중요
- **회원과 관련된 정보는 전혀 클라이언트에 전달되지 않는다**.
- 추정 불가능한 세션 ID만 쿠키를 통해 클라이언트에 전달된다.
### 세션을 사용한 로그인 방식의 장점
- 변조 가능한 쿠키 값을 예상 불가능한 세션 ID를 사용한다.
- 쿠키에 보관하는 정보는 클라이언트 해킹시 유출될 가능성이 있지만, 세션 ID에는 중요한 정보가 없기 때문에 이러한 보안 문제를 해결할 수 있다.
- 쿠키가 탈취된 경우 재사용이 가능하지만, 서버에서 세션의 만료시간을 짧게 유지하거나 해킹이 의심되는 경우 서버에서 해당 세션을 강제로 제거하는 방법으로 보안 문제를 해결할 수 있다.
---
# Spring에서 세션 직접 만들기
세션 관리는 크게 다음 3가지 기능을 제공하면 된다.
1. **세션 생성**
	- sessionId 생성(임의의 추적 불가능한 값)
	- 세션 저장소에 sessionId와 보관할 값 저장
	- sessionId로 응답 쿠키를 생성해서 클라이언트에 전달
2. **세션 조회**
	- 클라이언트가 요청한 sessionId 쿠키의 값으로 세션 저장소에 보관한 값 조회
3. **세션 만료**
	- 클라이언트가 요청한 sessionId 쿠키의 값으로 세션 저장소에 보관한 sessionId와 값 제거
